<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ProxyEndpoint name="map_getAccessToken">
    #common_oauth_request_flow_fault#
    <Flows>
        <Flow name="map_getAccessToken">
            <Request>
            <Step>
                <Name>assign_set_local_header_variables</Name>
            </Step>
            <Step>
                <Name>assign_set_local_query_variables</Name>
            </Step>
            <Step>
                <Name>verify_apikey_clientid</Name>
            </Step>
            <Step>
                <Condition>(verifyapikey.verify_apikey_clientid.client_secret != local_secret)</Condition>
                <Name>fault_invalid_secret</Name>
            </Step>
            #spike_arrest_and_quota#
            <Step>
                <Name>keymap_get_din_token_link</Name>
            </Step>
            <Step>
                <Name>fault_invalid_din</Name>
                <Condition>(access_token=null or access_token=EMPTY)</Condition>
            </Step>
        </Request>
            <Response>
                <Step>
                    <Name>assign_build_get_token_response</Name>
                </Step>
                -----CID REQUEST FLOW----------
                #common_cid_request_steps#
                -----Oauth REQUEST FLOW----------
                #common_oauth_request_flow_steps#
            </Response>
        </Flow>
    </Flows>
    <HTTPProxyConnection>
        <BasePath>/map/getAccessToken</BasePath>
        <VirtualHost>https_vhost</VirtualHost>
    </HTTPProxyConnection>
    <RouteRule name="no-road-ahead"/>
</ProxyEndpoint>